---
title: 'Kernel-Predicting Convolutional Networks for Denoising Monte Carlo Renderings'
# image : ""
date: '2022-07-27'
categories: [Paper review, MC denoising]
# tags: [tag] 
author: saha
math: true
mermaid: true
pin : false
---

# Abstract

Regression-based algorithms have shown to be good at denoising Monte Carlo (MC) renderings by leveraging its inexpensive by-products (e.g., feature buffers).
However, when using higher-order models to handle complex cases, these techniques often overfit to noise in the input. For this reason, supervised learning methods have been proposed that train on a large collection of reference examples, but they use explicit filters that limit their denoising ability. To address these problems, we propose a novel, supervised
learning approach that allows the filtering kernel to be more complex and general by leveraging a deep convolutional neural network (CNN) architecture.
In one embodiment of our framework, the CNN directly predicts the final denoised pixel value as a highly non-linear combination of the input features.
In a second approach, we introduce a novel, kernel-prediction network which uses the CNN to estimate the local weighting kernels used to
compute each denoised pixel from its neighbors. We train and evaluate our networks on production data and observe improvements over state-of-the art
MC denoisers, showing that our methods generalize well to a variety of scenes. 
We conclude by analyzing various components of our architecture and identify areas of further research in deep learning for MC denoising.

# Introduction

보다 더 정확한 image를 생성하기 위해, 과거에 사용하던 REYES-style micropolygon architecture[Cook et al. 1987]에서 physically-based Monte Carlo (MC) path tracing [Kajiya 1986] 으로 많이 넘어오고 있다. 이 방법은 ray tracing을 사용하며, rendering equation의 적분을 쉽게 하기 위해 Monte Carlo integration을 사용한다(\ref{a}). 

---

$$
L_o(p,\omega_o) = \int_{\Omega^{+}} L_i(p, \omega_i)f_r(p,\omega_i,\omega_o)(n\cdot\omega_i)\mathbf{d}\omega_i \approx \frac{1}{N}\sum^{N}_{i=1}\frac{L_i(p,\omega_i)f_r(p,\omega_i,\omega_o)(n\cdot\omega_i)}{p(\omega_i)} \label{a} \tag{1}
$$ 

---

Monte Carlo integration은 unbiased estimator이기 때문에, sample의 개수($N$)이 많다는 전제 하에 ground truth로 수렴하게 된다. 하지만 많은 spp(sample per pixel)을 사용하면 그만큼 시간이 오래 걸리게 되는데, 그래서 적은 spp로 noisy image를 뽑아내고, 여기에 denoising을 통해 clean image를 얻어내는 **Monte Carlo denoising** 이 연구되고 있다. 

이 논문 기준으로 sota method인 Kalantari et al.[2015] 에서는 MLP를 사용해서 denoising filter의 weight를 학습하는 방식을 채택했지만, 이는 적은 scene에 대해서만 학습되었고 고정된 filter 종류(joint bilateral or joint non-local means)만 사용하기 때문에 그 한계가 명확하다.
